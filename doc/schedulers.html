<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Working with Schedulers &#8212; stormpy 1.3.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with Shortest Paths" href="shortest_paths.html" />
    <link rel="prev" title="Reward Models" href="reward_models.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Stormpy</a>
        <span class="navbar-text navbar-version pull-left"><b>1.3.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="http://stormchecker.org">Storm</a></li>
                <li><a href="https://github.com/moves-rwth/stormpy">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Stormpy <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation-steps">Installation Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#a-quick-tour-through-stormpy">A Quick Tour through Stormpy</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../advanced_topics.html">Advanced Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="building_models.html">Building Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="engines.html">Engines</a></li>
<li class="toctree-l2"><a class="reference internal" href="exploration.html">Exploring Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="reward_models.html">Reward Models</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Working with Schedulers</a></li>
<li class="toctree-l2"><a class="reference internal" href="shortest_paths.html">Working with Shortest Paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="parametric_models.html">Parametric Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="dfts.html">Dynamic Fault Trees</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/core.html">Stormpy.core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/info.html">Stormpy.info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/exceptions.html">Stormpy.exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/logic.html">Stormpy.logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/storage.html">Stormpy.storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/utility.html">Stormpy.utility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/dft.html">Stormpy.dft</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/pars.html">Stormpy.pars</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Working with Schedulers</a><ul>
<li><a class="reference internal" href="#examining-schedulers-for-mdps">Examining Schedulers for MDPs</a></li>
<li><a class="reference internal" href="#examining-schedulers-for-markov-automata">Examining Schedulers for Markov automata</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="reward_models.html" title="Previous Chapter: Reward Models"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Reward Models</span>
    </a>
  </li>
  <li>
    <a href="shortest_paths.html" title="Next Chapter: Working with Shortest Paths"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Working with ... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="working-with-schedulers">
<h1>Working with Schedulers<a class="headerlink" href="#working-with-schedulers" title="Permalink to this headline">¶</a></h1>
<p>In non-deterministic models the notion of a scheduler (or policy) is important.
The scheduler determines which action to take at each state.</p>
<p>For a given reachability property, Storm can return the scheduler realizing the resulting probability.</p>
<div class="section" id="examining-schedulers-for-mdps">
<h2>Examining Schedulers for MDPs<a class="headerlink" href="#examining-schedulers-for-mdps" title="Permalink to this headline">¶</a></h2>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://github.com/moves-rwth/stormpy/blob/master/examples/schedulers/01-schedulers.py">01-schedulers.py</a></p>
</div>
<p>As in <a class="reference internal" href="../getting_started.html"><span class="doc">Getting Started</span></a>, we import some required modules and build a model from the example files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stormpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stormpy.core</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stormpy.examples</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stormpy.examples.files</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">prism_mdp_coin_2_2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">formula_str</span> <span class="o">=</span> <span class="s2">&quot;Pmin=? [F </span><span class="se">\&quot;</span><span class="s2">finished</span><span class="se">\&quot;</span><span class="s2"> &amp; </span><span class="se">\&quot;</span><span class="s2">all_coins_equal_1</span><span class="se">\&quot;</span><span class="s2">]&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">program</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">parse_prism_program</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">formulas</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">parse_properties</span><span class="p">(</span><span class="n">formula_str</span><span class="p">,</span> <span class="n">program</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">build_model</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">formulas</span><span class="p">)</span>
</pre></div>
</div>
<p>Next we check the model and make sure to extract the scheduler:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">model_checking</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">formulas</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extract_scheduler</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The result then contains the scheduler we want:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">has_scheduler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">scheduler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">scheduler</span><span class="o">.</span><span class="n">memoryless</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">scheduler</span><span class="o">.</span><span class="n">deterministic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scheduler</span><span class="p">)</span>
<span class="go">___________________________________________________________________</span>
<span class="go">Fully defined memoryless deterministic scheduler:</span>
<span class="go">model state:    choice(s)</span>
<span class="go">           0    0</span>
<span class="go">           1    0</span>
<span class="go">           2    1</span>
<span class="go">           3    0</span>
<span class="go">-etc-</span>
</pre></div>
</div>
<p>To get the information which action the scheduler chooses in which state, we can simply iterate over the states:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">states</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">choice</span> <span class="o">=</span> <span class="n">scheduler</span><span class="o">.</span><span class="n">get_choice</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">action</span> <span class="o">=</span> <span class="n">choice</span><span class="o">.</span><span class="n">get_deterministic_choice</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;In state </span><span class="si">{}</span><span class="s2"> choose action </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">))</span>
<span class="go">In state 0 choose action 0</span>
<span class="go">In state 1 choose action 0</span>
<span class="go">In state 2 choose action 1</span>
<span class="go">In state 3 choose action 0</span>
<span class="go">In state 4 choose action 0</span>
<span class="go">In state 5 choose action 0</span>
<span class="go">-etc-</span>
</pre></div>
</div>
</div>
<div class="section" id="examining-schedulers-for-markov-automata">
<h2>Examining Schedulers for Markov automata<a class="headerlink" href="#examining-schedulers-for-markov-automata" title="Permalink to this headline">¶</a></h2>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://github.com/moves-rwth/stormpy/blob/master/examples/schedulers/02-schedulers.py">02-schedulers.py</a></p>
</div>
<p>Currently there is no support yet for scheduler extraction on MAs.
However, if the timing information is not relevant for the property, we can circumvent this lack by first transforming the MA to an MDP.</p>
<p>We build the model as before:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">prism_ma_simple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">formula_str</span> <span class="o">=</span> <span class="s2">&quot;Tmin=? [ F s=4 ]&quot;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">program</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">parse_prism_program</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">formulas</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">parse_properties_for_prism_program</span><span class="p">(</span><span class="n">formula_str</span><span class="p">,</span> <span class="n">program</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ma</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">build_model</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">formulas</span><span class="p">)</span>
</pre></div>
</div>
<p>Next we transform the continuous-time model into a discrete-time model.
Note that all timing information is lost at this point.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdp</span><span class="p">,</span> <span class="n">mdp_formulas</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">transform_to_discrete_time_model</span><span class="p">(</span><span class="n">ma</span><span class="p">,</span> <span class="n">formulas</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">mdp</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">ModelType</span><span class="o">.</span><span class="n">MDP</span>
</pre></div>
</div>
<p>After the transformation we have obtained an MDP where we can extract the scheduler as shown before:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">model_checking</span><span class="p">(</span><span class="n">mdp</span><span class="p">,</span> <span class="n">mdp_formulas</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extract_scheduler</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">scheduler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scheduler</span><span class="p">)</span>
<span class="go">___________________________________________________________________</span>
<span class="go">Fully defined memoryless deterministic scheduler:</span>
<span class="go">model state:    choice(s)</span>
<span class="go">           0    1</span>
<span class="go">           1    0</span>
<span class="go">           2    0</span>
<span class="go">           3    0</span>
<span class="go">           4    0</span>
<span class="go">-etc-</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/doc/schedulers.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2016-2019 Moves RWTH Aachen.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>